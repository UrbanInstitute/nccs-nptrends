[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "NP Trends Survey Data Preparation Guide",
    "section": "",
    "text": "Preface\nThis is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "02-data-cleaning.html",
    "href": "02-data-cleaning.html",
    "title": "3  Cleaning the Survey Data",
    "section": "",
    "text": "In this chapter we process the raw survey data by:\n\nRenaming columns\nRecoding response values for quantitative analysis\nDropping duplicates, incomplete responses and test responses\n\n\n3.0.1 Renaming Columns\nColumns referencing survey questions are renamed with the help of a data dictionary to improve readability.\n\ntorename &lt;- dd %&gt;% \n  dplyr::select(vname, vname_raw) %&gt;% \n  tidyr::drop_na()\n\nsurvey_df &lt;- raw_survey_df %&gt;% \n  dplyr::rename_at(vars(torename$vname_raw), ~torename$vname)\n\n\n\n3.0.2 Recoding Survey Responses\nThe next step is recoding survey responses. Each group of survey questions comes with its own set of valid inputs that must be recoded separately. For example, “N/A”’s are options for some survey questions and not for others, and some survey questions allow for manual text inputs.\nThe below code chunk separates all survey questions into their respective categories before further separating each category into numeric, text or NA inputs.\nNA inputs here refer to “Check here if not applicable to your organization” columns in the survey, where a “C” indicates that the respondent has checked the N/A box.\n\n# All questions provided to respondents\nsurvey_qns &lt;- names(survey_df)[32:203]\n\n# Broken down into specific categories\nprogram_change_qns &lt;- survey_qns[1:15]\npeople_served_qns &lt;- survey_qns[16:19]\ndemand_qn &lt;- survey_qns[20:20]\n\n# Split into different variable type subgroups\nstaff_qns &lt;- survey_qns[21:47]\nstaff_qns_numeric &lt;- survey_qns[c(21:27, 29:36, 38)]\nstaff_qns_text &lt;- survey_qns[c(28, 37, 47)]\nstaff_qns_na &lt;- survey_qns[c(39:46)]\n\n# Rest of Qns To-Do if above are ok\nimportance_qns &lt;- survey_qns[48:49]\nfundraise_qns &lt;- survey_qns[50:60]\nmajorgift_qn &lt;- survey_qns[61:61]\nfundraise_change_qns &lt;- survey_qns[62:68]\nfundraise_donor_qns &lt;- survey_qns[69:70]\nfinance_fundraise_qns &lt;- survey_qns[71:96]\nfinance_revenue_qns &lt;- survey_qns[97:105]\nreserve_qns &lt;- survey_qns[110:111]\ncarse_qns &lt;- survey_qns[112:113]\nfinance_chng_qns &lt;- survey_qns[114:121]\nleadership_chng_qns &lt;- survey_qns[122:132]\nrace_gender_qns &lt;- survey_qns[133:158]\nextaffairs_qns &lt;- survey_qns[159:171]\nprimary_cncrn_qn &lt;- survey_qns[172:172]\n\n\n3.0.2.1 Survey Question Breakdown\n\n\n172 general survey questions\n15 questions about changes to programs and services\n4 questions about the number of people each organization serves\n1 question about overall program demand\n27 questions about staff numbers\n\n\n\n# Recode each category\nsurvey_recode_df &lt;- survey_df %&gt;% \n  dplyr::mutate(\n    dplyr::across(\n      program_change_qns,\n      ~ dplyr::case_match(\n        ., \n        \"Yes\" ~ 1, \"No\" ~ 0, \"N/A\" ~ 99, \n        \"Unsure\" ~ 98, \"-99\" ~ -99,\n        .default = NA\n      )\n    ),\n    dplyr::across(\n      people_served_qns,\n      ~ dplyr::case_match(\n        .,\n        \"-99\" ~ -99, NA ~ NA, \"N/A\" ~ 1,\n        .default = as.integer(.)\n      )\n    ),\n    dplyr::across(\n      demand_qn,\n      ~ dplyr::case_match(\n        .,\n        \"Increase\" ~ 98, \"Stay the same\" ~ 0, \"Decrease\" ~ 1,\n        \"-99\" ~ -99,\n        .default = NA\n      )\n    ),\n    dplyr::across(\n      staff_qns_numeric,\n      ~ dplyr::case_match(\n        .,\n        \"-99\" ~ -99, NA ~ NA,\n        .default = as.integer(.)\n      )\n    ),\n    dplyr::across(\n      staff_qns_text,\n      ~ dplyr::case_match(\n        .,\n        \"-99\" ~ \"-99\", NA ~ NA,\n        .default = as.character(.)\n      )\n    ),\n    dplyr::across(\n      tidyselect::all_of(staff_qns_na),\n      ~ dplyr::case_match(\n        .,\n        \"-99\" ~ -99, NA ~ NA, \"C\" ~ 1,\n        .default = NA\n      )\n    )\n  )\n\n\n# raw_survey_df %&gt;% \n#   dplyr::rowwise() %&gt;% \n#   dplyr::mutate(response_rate = sum(dplyr::c_across(tidyselect::all_of(survey_qns)) != -99, na.rm = TRUE)) %&gt;% \n#   dplyr::select(ResponseId, response_rate) %&gt;% \n#   dplyr::filter(! ResponseId %in% weighted_survey_df$ResponseId)"
  }
]